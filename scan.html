<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scan Huntee</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Scan Successful</h1>
    <p id="status">Logging your scan...</p>

    <script>
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        const hunteeId = getQueryParam('huntee');
        const hunterId = localStorage.getItem('hunterId');

        if (hunteeId && hunterId) {
            const data = new URLSearchParams();
            data.append('hunterId', hunterId);
            data.append('hunteeId', hunteeId);

            fetch('https://script.google.com/macros/s/AKfycbwj2uBW9CWcqcwsa4jPtK8EP8BMiJvgxfn-kXHAIraFMRfiPIgKA-SyZ4N2JFm4VEsL/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: data.toString()
            })
            .then(response => response.text())
            .then(text => {
                if (text.includes("Success")) {
                    document.getElementById('status').innerHTML = `<span class="success">Scan logged for Hunter ${hunterId} and Huntee ${hunteeId}!</span>`;
                } else {
                    document.getElementById('status').innerHTML = `<span class="error">Error logging scan: ${text}</span>`;
                }
            })
            .catch(error => {
                document.getElementById('status').innerHTML = `<span class="error">Network error: ${error}</span>`;
            });
        } else {
            document.getElementById('status').innerHTML = `<span class="error">Missing Hunter ID or Huntee ID.</span>`;
        }
    </script>
</body>
</html>
